{
  "id": "293d0d9f-c3ac-4a94-8b2f-a22fe9606521",
  "prevId": "c8460000-9377-4691-9a29-a3483d1d3d0d",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.fx_balance_reconciliations": {
      "name": "fx_balance_reconciliations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "period_start": {
          "name": "period_start",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "period_end": {
          "name": "period_end",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "reconciliation_type": {
          "name": "reconciliation_type",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true
        },
        "stripe_fiat_currency": {
          "name": "stripe_fiat_currency",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "stripe_opening_balance": {
          "name": "stripe_opening_balance",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_inflows": {
          "name": "stripe_inflows",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_outflows": {
          "name": "stripe_outflows",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_closing_balance": {
          "name": "stripe_closing_balance",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_expected_balance": {
          "name": "stripe_expected_balance",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "stripe_difference": {
          "name": "stripe_difference",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_token": {
          "name": "crypto_token",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "crypto_opening_balance": {
          "name": "crypto_opening_balance",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_swap_acquired": {
          "name": "crypto_swap_acquired",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_transferred_out": {
          "name": "crypto_transferred_out",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_closing_balance": {
          "name": "crypto_closing_balance",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_expected_balance": {
          "name": "crypto_expected_balance",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "crypto_difference": {
          "name": "crypto_difference",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "discrepancy_notes": {
          "name": "discrepancy_notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "resolved_by": {
          "name": "resolved_by",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": false
        },
        "resolved_at": {
          "name": "resolved_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_fx_reconciliation_period": {
          "name": "idx_fx_reconciliation_period",
          "columns": [
            {
              "expression": "period_end",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_reconciliation_status": {
          "name": "idx_fx_reconciliation_status",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.fx_rate_snapshots": {
      "name": "fx_rate_snapshots",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "from_currency": {
          "name": "from_currency",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "to_currency": {
          "name": "to_currency",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "rate": {
          "name": "rate",
          "type": "numeric(18, 8)",
          "primaryKey": false,
          "notNull": true
        },
        "source": {
          "name": "source",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "source_metadata": {
          "name": "source_metadata",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "confidence_score": {
          "name": "confidence_score",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": false
        },
        "spread_percent": {
          "name": "spread_percent",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {
        "idx_fx_rate_pair": {
          "name": "idx_fx_rate_pair",
          "columns": [
            {
              "expression": "from_currency",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            },
            {
              "expression": "to_currency",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_rate_timestamp": {
          "name": "idx_fx_rate_timestamp",
          "columns": [
            {
              "expression": "timestamp",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.fx_swap_configs": {
      "name": "fx_swap_configs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "platform_fee_percent": {
          "name": "platform_fee_percent",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": true,
          "default": "'0.5'"
        },
        "min_platform_fee_usd": {
          "name": "min_platform_fee_usd",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'1.00'"
        },
        "max_platform_fee_usd": {
          "name": "max_platform_fee_usd",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'50.00'"
        },
        "min_swap_amount_gbp": {
          "name": "min_swap_amount_gbp",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": true,
          "default": "'10.00'"
        },
        "max_swap_amount_gbp": {
          "name": "max_swap_amount_gbp",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": true,
          "default": "'10000.00'"
        },
        "daily_user_limit_gbp": {
          "name": "daily_user_limit_gbp",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false,
          "default": "'5000.00'"
        },
        "max_slippage_percent": {
          "name": "max_slippage_percent",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": false,
          "default": "'1.0'"
        },
        "fx_rate_validity_seconds": {
          "name": "fx_rate_validity_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 30
        },
        "required_block_confirmations": {
          "name": "required_block_confirmations",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 3
        },
        "fx_rate_sources": {
          "name": "fx_rate_sources",
          "type": "text[]",
          "primaryKey": false,
          "notNull": true
        },
        "hot_wallet_address": {
          "name": "hot_wallet_address",
          "type": "varchar(42)",
          "primaryKey": false,
          "notNull": true
        },
        "hot_wallet_min_balance": {
          "name": "hot_wallet_min_balance",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": true
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "maintenance_mode": {
          "name": "maintenance_mode",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "maintenance_message": {
          "name": "maintenance_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.fx_swap_orders": {
      "name": "fx_swap_orders",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "varchar(36)",
          "primaryKey": true,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true
        },
        "stripe_payment_intent_id": {
          "name": "stripe_payment_intent_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "client_order_id": {
          "name": "client_order_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": true
        },
        "fiat_currency": {
          "name": "fiat_currency",
          "type": "varchar(10)",
          "primaryKey": false,
          "notNull": true
        },
        "fiat_amount": {
          "name": "fiat_amount",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": true
        },
        "target_token": {
          "name": "target_token",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "target_token_amount": {
          "name": "target_token_amount",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "destination_wallet": {
          "name": "destination_wallet",
          "type": "varchar(42)",
          "primaryKey": false,
          "notNull": true
        },
        "fx_rate": {
          "name": "fx_rate",
          "type": "numeric(18, 8)",
          "primaryKey": false,
          "notNull": true
        },
        "fx_rate_source": {
          "name": "fx_rate_source",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": true
        },
        "fx_rate_timestamp": {
          "name": "fx_rate_timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "platform_fee_percent": {
          "name": "platform_fee_percent",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": true
        },
        "platform_fee_amount": {
          "name": "platform_fee_amount",
          "type": "numeric(18, 8)",
          "primaryKey": false,
          "notNull": false
        },
        "network_fee_amount": {
          "name": "network_fee_amount",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "total_fees_usd": {
          "name": "total_fees_usd",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "zero_x_quote_id": {
          "name": "zero_x_quote_id",
          "type": "varchar(255)",
          "primaryKey": false,
          "notNull": false
        },
        "zero_x_swap_data": {
          "name": "zero_x_swap_data",
          "type": "jsonb",
          "primaryKey": false,
          "notNull": false
        },
        "executed_price": {
          "name": "executed_price",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "slippage_percent": {
          "name": "slippage_percent",
          "type": "numeric(5, 4)",
          "primaryKey": false,
          "notNull": false
        },
        "swap_tx_hash": {
          "name": "swap_tx_hash",
          "type": "varchar(66)",
          "primaryKey": false,
          "notNull": false
        },
        "transfer_tx_hash": {
          "name": "transfer_tx_hash",
          "type": "varchar(66)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_code": {
          "name": "error_code",
          "type": "varchar(50)",
          "primaryKey": false,
          "notNull": false
        },
        "retry_count": {
          "name": "retry_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "stripe_confirmed_at": {
          "name": "stripe_confirmed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "fx_rate_locked_at": {
          "name": "fx_rate_locked_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "swap_started_at": {
          "name": "swap_started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "swap_completed_at": {
          "name": "swap_completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "transfer_started_at": {
          "name": "transfer_started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "failed_at": {
          "name": "failed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "ip_address": {
          "name": "ip_address",
          "type": "varchar(45)",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_fx_swap_user": {
          "name": "idx_fx_swap_user",
          "columns": [
            {
              "expression": "user_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_swap_stripe_payment": {
          "name": "idx_fx_swap_stripe_payment",
          "columns": [
            {
              "expression": "stripe_payment_intent_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_swap_status": {
          "name": "idx_fx_swap_status",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_swap_created": {
          "name": "idx_fx_swap_created",
          "columns": [
            {
              "expression": "created_at",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "fx_swap_orders_user_id_users_id_fk": {
          "name": "fx_swap_orders_user_id_users_id_fk",
          "tableFrom": "fx_swap_orders",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "fx_swap_orders_stripe_payment_intent_id_unique": {
          "name": "fx_swap_orders_stripe_payment_intent_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stripe_payment_intent_id"
          ]
        },
        "fx_swap_orders_client_order_id_unique": {
          "name": "fx_swap_orders_client_order_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "client_order_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.fx_wallet_operations": {
      "name": "fx_wallet_operations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "serial",
          "primaryKey": true,
          "notNull": true
        },
        "fx_swap_order_id": {
          "name": "fx_swap_order_id",
          "type": "varchar(36)",
          "primaryKey": false,
          "notNull": true
        },
        "operation_type": {
          "name": "operation_type",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true
        },
        "token": {
          "name": "token",
          "type": "varchar(20)",
          "primaryKey": false,
          "notNull": true
        },
        "amount": {
          "name": "amount",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": true
        },
        "from_address": {
          "name": "from_address",
          "type": "varchar(42)",
          "primaryKey": false,
          "notNull": true
        },
        "to_address": {
          "name": "to_address",
          "type": "varchar(42)",
          "primaryKey": false,
          "notNull": true
        },
        "chain_id": {
          "name": "chain_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "network": {
          "name": "network",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true
        },
        "tx_hash": {
          "name": "tx_hash",
          "type": "varchar(66)",
          "primaryKey": false,
          "notNull": false
        },
        "block_number": {
          "name": "block_number",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "confirmations": {
          "name": "confirmations",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "required_confirmations": {
          "name": "required_confirmations",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 3
        },
        "gas_price": {
          "name": "gas_price",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "gas_used": {
          "name": "gas_used",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "gas_fee_paid": {
          "name": "gas_fee_paid",
          "type": "numeric(30, 18)",
          "primaryKey": false,
          "notNull": false
        },
        "gas_fee_usd": {
          "name": "gas_fee_usd",
          "type": "numeric(18, 2)",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "varchar(30)",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "broadcast_at": {
          "name": "broadcast_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "confirmed_at": {
          "name": "confirmed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "failed_at": {
          "name": "failed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {
        "idx_fx_wallet_order": {
          "name": "idx_fx_wallet_order",
          "columns": [
            {
              "expression": "fx_swap_order_id",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_wallet_tx_hash": {
          "name": "idx_fx_wallet_tx_hash",
          "columns": [
            {
              "expression": "tx_hash",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        },
        "idx_fx_wallet_status": {
          "name": "idx_fx_wallet_status",
          "columns": [
            {
              "expression": "status",
              "isExpression": false,
              "asc": true,
              "nulls": "last"
            }
          ],
          "isUnique": false,
          "concurrently": false,
          "method": "btree",
          "with": {}
        }
      },
      "foreignKeys": {
        "fx_wallet_operations_fx_swap_order_id_fx_swap_orders_id_fk": {
          "name": "fx_wallet_operations_fx_swap_order_id_fx_swap_orders_id_fk",
          "tableFrom": "fx_wallet_operations",
          "tableTo": "fx_swap_orders",
          "columnsFrom": [
            "fx_swap_order_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {},
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}